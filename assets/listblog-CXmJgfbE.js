import{r as o,j as s}from"./index-Sf5Pd2Ti.js";import{C as S}from"./index.esm-BahTF8SP.js";import{d as E,e as O,f as $}from"./api-8NfXm4mA.js";import{C as q,a as P}from"./CCardBody-DteA4Sq5.js";import{C as W}from"./CCardHeader-DqvsIKna.js";import{C as Y}from"./CAlert-CCDvFhTI.js";import{C as z,a as G,b,c as r,d as J,e as n}from"./CTable-BH3Hfq1k.js";import{C as K}from"./CImage-BEoKLxN7.js";import{c as Q,a as X}from"./cil-trash-prAk5aip.js";import{C as L,a as N,b as T,c as M}from"./CModalHeader-DZkYYLr8.js";import{C as u}from"./CFormInput-Bx6A_21m.js";import{C as Z}from"./CFormLabel-CNJBeCYv.js";import{C as ee}from"./CFormSelect-1flQ4BUc.js";import{C as se}from"./CFormTextarea-Cr2cKXNJ.js";import{a as j}from"./CContainer-BMsFnlVt.js";import{C as le}from"./CModalTitle-M6Bh-emi.js";import"./DefaultLayout-BvKVTqpM.js";import"./cil-lock-locked-DmxpJbVL.js";import"./CFormControlWrapper-DC2XLO_Y.js";import"./CFormControlValidation-BkgEcxHQ.js";const Be=()=>{const[c,v]=o.useState([]),[w,m]=o.useState(!1),[A,y]=o.useState(null),[l,h]=o.useState({id:"",title:"",images:[],imageFiles:[],description:"",date:"",sports_name:""}),[_,I]=o.useState({title:"",description:"",date:"",sports_name:""}),B=A||(l==null?void 0:l.imageFiles),[C,D]=o.useState({visible:!1,color:"",message:""}),[F,d]=o.useState(!1);o.useEffect(()=>{g()},[]);const f=(e,i)=>{D({visible:!0,color:e,message:i}),setTimeout(()=>D({visible:!1,color:"",message:""}),5e3)},g=()=>{E().then(e=>{var i,a;((i=e.data)==null?void 0:i.status)==200?v((a=e==null?void 0:e.data)==null?void 0:a.data):v([])}).catch(e=>{console.log(e)})},k=e=>{d(e)},H=()=>{$(F).then(e=>{var i,a;e.status==200?(g(),d(!1),f("success",(i=e==null?void 0:e.data)==null?void 0:i.message)):(d(!1),f("danger",(a=e==null?void 0:e.data)==null?void 0:a.message))}).catch(e=>{console.log("error",e)})},R=e=>{h({id:e==null?void 0:e.id,title:e==null?void 0:e.title,images:[{url:e==null?void 0:e.file_url}],imageFiles:[],description:e==null?void 0:e.description,date:e==null?void 0:e.created_at,sports_name:e==null?void 0:e.sports_type}),y(e==null?void 0:e.file_url),m(!0)},x=e=>{const{name:i,value:a}=e.target;h({...l,[i]:a})},U=e=>{const i=e.target.files,a=e.target.files[0];if(a){const t=URL.createObjectURL(a);y(t)}if(i.length>0){const t=Array.from(i).map(p=>({url:URL.createObjectURL(p),filename:p.name,file:p}));h({...l,images:[...l.images,...t],imageFiles:[...l.imageFiles,...i]}),_.images&&I({..._,images:""})}},V=async e=>{e.preventDefault();try{const i=l.id,a=new FormData;a.append("title",l.title),a.append("date",l.date),a.append("description",l.description),a.append("sports_name",l.sports_name),l.imageFiles.forEach(p=>{a.append("file",p)});const t=await O(i,a);console.log("responseresponse",t),t&&t.status===200?(f("success","Media saved successfully!"),m(!1),g(),h({title:"",sports_name:"",description:"",images:[],imageFiles:[]})):(console.log("danger",`Error: ${(t==null?void 0:t.error)||"Failed to save media"}`),m(!1))}catch(i){console.log("danger",`Error: ${i.message||"Unknown error"}`)}finally{}};return s.jsxs(s.Fragment,{children:[s.jsxs(q,{className:"",children:[s.jsx(W,{children:s.jsx("h3",{children:"Blog List"})}),s.jsxs(P,{children:[C.visible&&s.jsx(Y,{color:C.color,children:C.message}),s.jsxs(z,{striped:!0,hover:!0,responsive:!0,className:"custom-table",children:[s.jsx(G,{children:s.jsxs(b,{children:[s.jsx(r,{children:"#"}),s.jsx(r,{children:"Title"}),s.jsx(r,{children:"Sport Type"}),s.jsx(r,{children:"Date"}),s.jsx(r,{children:"Image"}),s.jsx(r,{children:"Description"}),s.jsx(r,{children:"Actions"})]})}),s.jsx(J,{children:(c==null?void 0:c.length)>0?c==null?void 0:c.map((e,i)=>s.jsxs(b,{children:[s.jsx(n,{children:i+1}),s.jsx(n,{children:e.title}),s.jsx(n,{children:e.sports_type}),s.jsx(n,{children:e.created_at}),s.jsx(n,{children:s.jsx(K,{src:e==null?void 0:e.file_url,alt:(e==null?void 0:e.media_file)||"media",width:100,thumbnail:!0})}),s.jsx(n,{children:s.jsx("div",{dangerouslySetInnerHTML:{__html:e.description},className:"ellipsis",title:e.description})}),s.jsxs(n,{children:[s.jsx(S,{icon:Q,className:"me-2 text-primary",role:"button",onClick:()=>R(e)}),s.jsx(S,{icon:X,className:"text-danger",role:"button",onClick:()=>k(e==null?void 0:e.id)})]})]},i)):s.jsx(s.Fragment,{})})]})]})]}),s.jsxs(L,{visible:w,onClose:()=>m(!1),children:[s.jsx(N,{children:"Edit Blog"}),s.jsxs(T,{children:[s.jsx(u,{label:"Title",name:"title",value:(l==null?void 0:l.title)||"",onChange:x,className:"mb-3"}),s.jsx(Z,{htmlFor:"sports_name",children:"Sport Name"}),s.jsxs(ee,{name:"sports_name",id:"sports_name",value:l==null?void 0:l.sports_name,onChange:x,required:!0,className:"mb-3",children:[s.jsx("option",{value:"",children:l!=null&&l.sports_name?l==null?void 0:l.sports_name:"Select a sport"}),s.jsx("option",{value:"MLB",children:"MLB"}),s.jsx("option",{value:"NBA",children:"NBA"}),s.jsx("option",{value:"NHL",children:"NHL"})]}),s.jsx(u,{label:"Date",type:"date",name:"date",value:(l==null?void 0:l.date)||"",onChange:x,className:"mb-3"}),B&&s.jsx("div",{className:"mb-3",children:s.jsx("img",{src:B,alt:"Current",style:{maxWidth:"200px",borderRadius:"8px"}})}),s.jsx(u,{type:"file",accept:"image/*",name:"image",id:"image",className:"mb-3",onChange:U}),s.jsx(se,{label:"Description",rows:"4",name:"description",value:(l==null?void 0:l.description)||"",onChange:x})]}),s.jsxs(M,{children:[s.jsx(j,{color:"secondary",onClick:()=>m(!1),children:"Cancel"}),s.jsx(j,{color:"primary",onClick:V,children:"Save Changes"})]})]}),s.jsxs(L,{alignment:"center",visible:F,onClose:()=>d(!1),"aria-labelledby":"LiveDemoExampleLabel",children:[s.jsx(N,{children:s.jsx(le,{id:"LiveDemoExampleLabel",children:"Delete Blog"})}),s.jsx(T,{children:s.jsxs("div",{children:[s.jsx("h4",{children:"Are you Sure?"}),s.jsx("p",{children:"You want to delete this blog."})]})}),s.jsxs(M,{children:[s.jsx(j,{color:"secondary",onClick:()=>d(!1),children:"Close"}),s.jsx(j,{color:"primary",onClick:()=>H(),children:"Delete"})]})]})]})};export{Be as default};
