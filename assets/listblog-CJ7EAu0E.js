import{r,j as s}from"./index-44eXkCoi.js";import{C as S}from"./index.esm-BY5HkIgC.js";import{d as E,e as O,f as $}from"./api-CX3y1q1W.js";import{C as q,a as P}from"./CCardBody-DzXBXlR9.js";import{C as W}from"./CCardHeader-Do69owr_.js";import{C as Y}from"./CAlert-Dy1eWsIA.js";import{C as z,a as G,b as L,c as o,d as J,e as n}from"./CTable-ehdUlGE3.js";import{C as K}from"./CImage-Bj5fPpZs.js";import{c as Q,a as X}from"./cil-trash-prAk5aip.js";import{C as N,a as T,b,c as M}from"./CModalHeader-K3BYd4iV.js";import{C as g}from"./CFormInput-DNvH8Co6.js";import{C as Z}from"./CFormLabel-DUsAr57M.js";import{C as ee}from"./CFormSelect-BiBneiZN.js";import{C as se}from"./CFormTextarea-DH4x6D6S.js";import{a as j}from"./CContainer-B9kgudL3.js";import{C as ie}from"./CModalTitle-BKXT56xq.js";import"./DefaultLayout-DIMP3MIY.js";import"./cil-lock-locked-DmxpJbVL.js";import"./CFormControlWrapper-ClSf6-o2.js";import"./CFormControlValidation-DFl6kdpn.js";const Be=()=>{const[c,v]=r.useState([]),[w,m]=r.useState(!1),[A,y]=r.useState(null),[i,h]=r.useState({id:"",title:"",images:[],imageFiles:[],description:"",date:"",sports_name:""}),[_,I]=r.useState({title:"",description:"",date:"",sports_name:""}),B=A||(i==null?void 0:i.imageFiles),[C,D]=r.useState({visible:!1,color:"",message:""}),[F,d]=r.useState(!1);r.useEffect(()=>{u()},[]);const f=(e,l)=>{D({visible:!0,color:e,message:l}),setTimeout(()=>D({visible:!1,color:"",message:""}),5e3)},u=()=>{E().then(e=>{var l,a;((l=e.data)==null?void 0:l.status)==200?v((a=e==null?void 0:e.data)==null?void 0:a.data):v([])}).catch(e=>{console.log(e)})},k=e=>{d(e)},H=()=>{$(F).then(e=>{var l,a;e.status==200?(u(),d(!1),f("success",(l=e==null?void 0:e.data)==null?void 0:l.message)):(d(!1),f("danger",(a=e==null?void 0:e.data)==null?void 0:a.message))}).catch(e=>{console.log("error",e)})},R=e=>{h({id:e==null?void 0:e.id,title:e==null?void 0:e.title,images:[{url:e==null?void 0:e.file_url}],imageFiles:[],description:e==null?void 0:e.description,date:e==null?void 0:e.created_at,sports_name:e==null?void 0:e.sports_type}),y(e==null?void 0:e.file_url),m(!0)},x=e=>{const{name:l,value:a}=e.target;h({...i,[l]:a})},U=e=>{const l=e.target.files,a=e.target.files[0];if(a){const t=URL.createObjectURL(a);y(t)}if(l.length>0){const t=Array.from(l).map(p=>({url:URL.createObjectURL(p),filename:p.name,file:p}));h({...i,images:[...i.images,...t],imageFiles:[...i.imageFiles,...l]}),_.images&&I({..._,images:""})}},V=async e=>{e.preventDefault();try{const l=i.id,a=new FormData;a.append("title",i.title),a.append("date",i.date),a.append("description",i.description),a.append("sports_name",i.sports_name),i.imageFiles.forEach(p=>{a.append("file",p)});const t=await O(l,a);t&&t.status===200?(f("success","Media saved successfully!"),m(!1),u(),h({title:"",sports_name:"",description:"",images:[],imageFiles:[]})):(console.log("danger",`Error: ${(t==null?void 0:t.error)||"Failed to save media"}`),m(!1))}catch(l){console.log("danger",`Error: ${l.message||"Unknown error"}`)}finally{}};return s.jsxs(s.Fragment,{children:[s.jsxs(q,{className:"",children:[s.jsx(W,{children:s.jsx("h3",{children:"Blog List"})}),s.jsxs(P,{children:[C.visible&&s.jsx(Y,{color:C.color,children:C.message}),s.jsxs(z,{striped:!0,hover:!0,responsive:!0,className:"custom-table",children:[s.jsx(G,{children:s.jsxs(L,{children:[s.jsx(o,{children:"#"}),s.jsx(o,{children:"Title"}),s.jsx(o,{children:"Sport Type"}),s.jsx(o,{children:"Date"}),s.jsx(o,{children:"Image"}),s.jsx(o,{children:"Description"}),s.jsx(o,{children:"Actions"})]})}),s.jsx(J,{children:(c==null?void 0:c.length)>0?c==null?void 0:c.map((e,l)=>{var a;return s.jsxs(L,{children:[s.jsx(n,{children:l+1}),s.jsx(n,{title:e.title,children:(a=e==null?void 0:e.title)==null?void 0:a.slice(0,30)}),s.jsx(n,{children:e.sports_type}),s.jsx(n,{children:e.created_at}),s.jsx(n,{children:s.jsx(K,{src:e==null?void 0:e.file_url,alt:(e==null?void 0:e.media_file)||"media",width:100,thumbnail:!0})}),s.jsx(n,{children:s.jsx("div",{dangerouslySetInnerHTML:{__html:e.description},className:"ellipsis single-line",title:e.description})}),s.jsxs(n,{children:[s.jsx(S,{icon:Q,className:"me-2 text-primary",role:"button",onClick:()=>R(e)}),s.jsx(S,{icon:X,className:"text-danger",role:"button",onClick:()=>k(e==null?void 0:e.id)})]})]},l)}):s.jsx(s.Fragment,{})})]})]})]}),s.jsxs(N,{visible:w,onClose:()=>m(!1),children:[s.jsx(T,{children:"Edit Blog"}),s.jsxs(b,{children:[s.jsx(g,{label:"Title",name:"title",value:(i==null?void 0:i.title)||"",onChange:x,className:"mb-3"}),s.jsx(Z,{htmlFor:"sports_name",children:"Sport Name"}),s.jsxs(ee,{name:"sports_name",id:"sports_name",value:i==null?void 0:i.sports_name,onChange:x,required:!0,className:"mb-3",children:[s.jsx("option",{value:"",children:i!=null&&i.sports_name?i==null?void 0:i.sports_name:"Select a sport"}),s.jsx("option",{value:"MLB",children:"MLB"}),s.jsx("option",{value:"NBA",children:"NBA"}),s.jsx("option",{value:"NHL",children:"NHL"})]}),s.jsx(g,{label:"Date",type:"date",name:"date",value:(i==null?void 0:i.date)||"",onChange:x,className:"mb-3"}),B&&s.jsx("div",{className:"mb-3",children:s.jsx("img",{src:B,alt:"Current",style:{maxWidth:"200px",borderRadius:"8px"}})}),s.jsx(g,{type:"file",accept:"image/*",name:"image",id:"image",className:"mb-3",onChange:U}),s.jsx(se,{label:"Description",rows:"4",name:"description",value:(i==null?void 0:i.description)||"",onChange:x})]}),s.jsxs(M,{children:[s.jsx(j,{color:"secondary",onClick:()=>m(!1),children:"Cancel"}),s.jsx(j,{color:"primary",onClick:V,children:"Save Changes"})]})]}),s.jsxs(N,{alignment:"center",visible:F,onClose:()=>d(!1),"aria-labelledby":"LiveDemoExampleLabel",children:[s.jsx(T,{children:s.jsx(ie,{id:"LiveDemoExampleLabel",children:"Delete Blog"})}),s.jsx(b,{children:s.jsxs("div",{children:[s.jsx("h4",{children:"Are you Sure?"}),s.jsx("p",{children:"You want to delete this blog."})]})}),s.jsxs(M,{children:[s.jsx(j,{color:"secondary",onClick:()=>d(!1),children:"Close"}),s.jsx(j,{color:"primary",onClick:()=>H(),children:"Delete"})]})]})]})};export{Be as default};
